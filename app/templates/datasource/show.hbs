<div class="row">
  <div class="col s12">
    <h4>Datasource - {{text-titlecase model.id}}</h4>
  </div>
</div>

<div class="row">
  <div class="col m3 s12">
    {{md-select
      label="TopK Ranking Metric"
      content=model.metrics
      value=topNRankingMetric}}
  </div>
	<div class="col m3 s12">
		{{md-input-date label='Start Date' value=startDateStr}}
	</div>
	<div class="col m3 s12">
		{{md-input-date label='End Date' value=endDateStr}}

	</div>

	<div class="col m3 s12">
		{{md-select
			label="Time Granularity"
			content=allTimeGranularities
			value=timeGranularity
			optionValuePath="content"
			optionLabelPath="content"}}
	</div>
  <div class="col m6 s12">
    {{md-selectize
      label="TopN Dimensions"
      content=model.dimensions
      multiple=true
      selection=topNDimensions}}
  </div>
  <div class="col m6 s12">
    {{md-selectize
      label="Time series metrics"
      content=model.metrics
      multiple=true
      selection=timeSeriesMetrics}}
  </div>

{{!--
  <div class="col m6 s12">
    {{md-selectize
      label="TopN Dimensions"
      multiple=true
      content=model.dimensions
      selected=topKDimensions}}
  </div>
  <div class="col m6 s12">
    {{md-selectize
      label="Time Series Metrics"
      multiple=true
      content=model.metrics
      selected=timeSeriesMetrics}}
  </div> --}}

</div>

<div class="row">
  <div class="col s12 m7 topN-lists">
    {{#each topNData as |topNDataItem|}}
      <div class="col s12">
      {{druid-top-n-list
        dimension=topNDataItem.dimension
        rankingMetric=topNRankingMetric
        content=topNDataItem.data}}
      </div>
    {{/each}}
  </div>
  <div class="col s12 m5">
    {{#each _timeSeriesArrays itemController="tracking" as |series|}}
      {{#md-card title=(text-titlecase series.model.metric)}}
        {{#md-card-content}}
          {{#nf-graph width=400 height=150}}
            {{#nf-graph-content}}
              {{nf-area data=series.model.points interpolator="basis" trackingMode="hover" trackedData=series.tracker}}
            {{/nf-graph-content}}
            {{#nf-y-axis as |tick|}}
              <text>{{nice-number tick.value}}</text>
            {{/nf-y-axis}}
            {{#nf-x-axis tickCount=4 as |tick|}}
              <text>{{moment tick.value 'll'}}</text>
            {{/nf-x-axis}}
          {{/nf-graph}}

          {{#if series.tracker}}
            {{moment series.tracker.x 'll'}}: {{nice-number series.tracker.y}}
          {{/if}}
        {{/md-card-content}}
      {{/md-card}}
    {{else}}
      {{#md-card title='No Timeseries Results'}}
        {{#md-card-content}}
          The druid broker node returned no timeseries data.
        {{/md-card-content}}
      {{/md-card}}
    {{/each}}
  </div>
</div>
